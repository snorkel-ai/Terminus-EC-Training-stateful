-- Compact batch 22/29: rows 1051-1100

INSERT INTO task_inspiration (category, subcategory, subsubcategory, description, difficulty, tags) VALUES
('Security & Cryptography', 'Network & System Penetration Testing', 'Exploit Simulation & Payload Delivery', 'Exploit a Shellshock vulnerability in a CGI-enabled web service by sending a crafted HTTP header that executes a controlled payload to create /app/pwned.txt and print the effective UID. Then harden the server (e.g., CGI config or shell update) and verify the payload no longer executes.', 'hard', ARRAY['web']),
('Security & Cryptography', 'Network & System Penetration Testing', 'Exploit Simulation & Payload Delivery', 'Exploit a misconfigured JWT verification flow vulnerable to HS/RS algorithm confusion by crafting a forged admin token to access a protected API and read /app/flag.txt. The task validates payload delivery by confirming elevated access and can be extended with a code/config hardening fix.', 'hard', ARRAY['api']),
('Security & Cryptography', 'Network & System Penetration Testing', 'Exploit Simulation & Payload Delivery', 'Exploit an unsafe YAML deserialization endpoint in a Python microservice that uses yaml.load on user input to achieve remote command execution. Craft and deliver a payload from the terminal that writes /tmp/pwn1, /tmp/pwn2, and /tmp/pwn3 and verifies their creation.', NULL, ARRAY['python']),
('Security & Cryptography', 'Network & System Penetration Testing', 'Port Scanning & Enumeration', 'Design a command-line workflow that uses masscan for fast discovery and nmap (with select NSE scripts) for deep enumeration to build a complete inventory of open TCP/UDP ports and service metadata across a provided 172.20.0.0/24 sandbox network. The tool should fall back to netcat banner grabs when NSE is inconclusive and write a normalized JSON report to /app/scan.json plus a brief human summary to /app/REPORT.md.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Port Scanning & Enumeration', 'In a dual-stack (IPv4/IPv6) sandbox with multiple interfaces, perform comprehensive TCP/UDP scanning to enumerate open ports, service versions, and TLS SNI/ALPN-based virtual hosts using nmap, masscan, and netcat. Extract a port-knocking sequence from a discovered banner to temporarily expose a hidden management port and produce a structured report of all findings.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Port Scanning & Enumeration', 'Perform TCP and UDP scans against the target to find open ports, fingerprint services (and versions) on non-standard ports, and detect protocol mismatches such as SSH speaking on 8080 or HTTP wrapped in TLS on 8443 using banner grabs and NSE scripts. Produce a machine-readable inventory (including port, transport, service, version, HTTP titles, and TLS certificate SHA-256 fingerprints) at /app/scan/report.json.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Port Scanning & Enumeration', 'Scan node1 and node2 for open TCP and UDP ports using masscan or nmap, then perform service enumeration (nmap -sV/-sC plus banner grabs with netcat/curl) to capture service names, versions, HTTP titles, TLS certificate CNs, and SSH key fingerprints. Produce a deduplicated, host-and-port-sorted JSON report at /app/scan_results.json summarizing all discovered endpoints and metadata.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Port Scanning & Enumeration', 'Scan the provided lab subnet to discover an HTTP service on a non-standard TCP port, an SNMP agent on UDP 161, and a custom binary service on an unknown port. Use nmap (including relevant NSE scripts) and netcat/openssl to enumerate and write the HTTP title, SNMP sysName, and the custom service’s banner to /app/enum.txt.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Post-Exploitation & Persistence Analysis', 'After a simulated compromise, build a CLI triage tool that hunts for stealthy Linux persistence (systemd timers/units, cron spools, SSH authorized_keys options, and /etc/ld.so.preload), disables any malicious entries safely, and emits a machine-readable remediation report. Validate by proving the planted persistence no longer triggers while legitimate services remain functional.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Post-Exploitation & Persistence Analysis', 'After an authorized compromise of a Linux host, enumerate and analyze multiple persistence footholds including a masqueraded systemd unit, an SSH authorized_keys entry with a forced-command, and a cron job carrying a base64-encoded payload. Decode each mechanism, map it to its on-disk artifacts and startup triggers, generate a JSON report with indicators of compromise, and disable the persistence so it does not survive reboot.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Post-Exploitation & Persistence Analysis', 'Analyze a compromised Linux host that employs layered persistence—a PATH-hijacked systemctl shim, a systemd service drop-in masquerading as a core daemon, an /etc/ld.so.preload hook, and a cron self-healer using immutable files—to identify, validate, and eradicate each mechanism. Produce a machine-readable IOC report (paths, hashes, service/timer names, environment changes) and a verification script that proves persistence does not return after service restarts.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Post-Exploitation & Persistence Analysis', 'Investigate a compromised Linux host to enumerate and validate stealth persistence mechanisms (e.g., a malicious systemd drop-in, cron.d @reboot job, LD_PRELOAD via /etc/ld.so.preload, and an SSH authorized_keys forced-command backdoor), safely neutralize each, and produce a machine-readable report at /app/persistence_report.json. Ensure legitimate services and user access remain unaffected while removing only malicious artifacts.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Post-Exploitation & Persistence Analysis', 'On a compromised Linux host, locate and neutralize multiple persistence mechanisms (a masqueraded systemd service, an LD_PRELOAD backdoor, and a cron-based beacon) without disrupting legitimate services, then produce /app/findings.json detailing each artifact, removal steps, and verification evidence. Confirm remediation by showing the backdoor no longer injects into sshd and that no malicious systemd timers or cron entries remain.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Privilege Escalation Simulation', 'As a low-privileged user, enumerate scheduled tasks and exploit a root cron backup that runs tar on a world-writable directory by abusing wildcard/--checkpoint-action injection to execute a root command. Confirm escalation by reading /root/flag.txt into /app/result.txt and creating a root-owned marker file in /tmp.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Privilege Escalation Simulation', 'Escalate from an unprivileged user to root by abusing an NFS export mounted in the sandbox that was configured without root_squash, demonstrating creation and execution of a setuid helper on the share. After obtaining root, apply and verify the remediation by correcting the export configuration and filesystem permissions so the escalation no longer works.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Privilege Escalation Simulation', 'Identify and exploit a misconfigured Linux capability on a helper binary (e.g., cap_setuid+ep) to escalate privileges and read a root-only secret. Output the exact contents of /root/flag.txt to /app/result.txt without altering system state beyond what’s required.', NULL, NULL),
('Security & Cryptography', 'Network & System Penetration Testing', 'Privilege Escalation Simulation', 'Simulate a privilege escalation via Python library path hijacking of a root-run systemd timer. The agent must find a group-writable plugin directory used by a backup script, plant a malicious module to execute as root on the next run, create /root/owned.txt as proof, and then revert the change.', NULL, ARRAY['python']),
('Security & Cryptography', 'Network & System Penetration Testing', 'Privilege Escalation Simulation', 'Starting from an unprivileged user, enumerate the host to discover a root cron job that uses tar against a writable directory and exploit tar’s wildcard/--checkpoint-action behavior to execute code as root and write a proof file. Then remediate by correcting permissions and hardening the backup command to use absolute paths and safe options so the escalation path is closed.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Container & Cloud Hardening', 'Build a CLI that hardens a Docker Compose project by enforcing least-privilege defaults (non-root user, read-only filesystem, dropped capabilities, no-new-privileges, seccomp/AppArmor profiles, CPU/memory limits, and read-only mounts unless whitelisted) and rewrites compose.yaml in place. Provide a verification script that launches the stack and uses docker inspect to confirm each service satisfies the required constraints.', 'hard', ARRAY['docker']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Container & Cloud Hardening', 'Harden a Docker Compose application by rewriting its services to run as non-root with read-only root filesystems, drop all capabilities (add back only what’s required), enable no-new-privileges, apply a strict seccomp profile, and set memory/PIDs limits. Validate that the app still functions while attempts to perform privileged actions (e.g., mounting, ptrace, writing to root-owned paths) fail within the containers.', 'hard', ARRAY['docker']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Container & Cloud Hardening', 'Harden a Docker Compose-based microservice by running containers as non-root, dropping unnecessary capabilities, enabling no-new-privileges, read-only root filesystems, strict seccomp/AppArmor profiles, and segmented networks with egress allowlists. Implement a policy-as-code linter (e.g., OPA/conftest) that validates the Compose file against these controls, and ensure the project passes the checks.', 'hard', ARRAY['docker']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Container & Cloud Hardening', 'Harden a Dockerized service to run rootless with user-namespace remapping, read-only rootfs and tmpfs overlays, minimal capabilities (e.g., only NET_BIND_SERVICE), no-new-privileges, custom seccomp/AppArmor profiles, and strict ulimits/cgroup constraints while preserving functionality. Provide a docker-compose setup that blocks 169.254.169.254 and non-whitelisted egress, denies hostPath mounts and Docker socket access, and verifies the container cannot write outside its volume or invoke ptrace/keyctl/mount syscalls while health checks pass.', 'hard', ARRAY['docker', 'container']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Container & Cloud Hardening', 'Harden a local Kubernetes cluster by enabling Pod Security Admission at ''restricted'' on a target namespace and adding OPA Gatekeeper constraints requiring runAsNonRoot, readOnlyRootFilesystem, seccompProfile RuntimeDefault, and all capabilities dropped; verify by applying both noncompliant and compliant workloads and writing an enforcement report to a file. Ensure privileged, host* options, and hostPath mounts are rejected while the compliant Deployment runs successfully.', 'hard', ARRAY['kubernetes', 'security']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Filesystem & Permission Security', 'Audit a containerized service for insecure file permissions and symlink misuse: find world-readable secrets and an uploads directory that permits symlink-based writes, then harden by correcting ownership/modes, adding sticky bits where needed, and enforcing least-privilege with POSIX (default) ACLs for the service user. Demonstrate remediation by showing unprivileged users can no longer read the secrets or redirect writes via symlinks.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Filesystem & Permission Security', 'Audit a multi-user workspace to detect world-readable secrets and symlink-based write-escape hazards in shared paths (e.g., /tmp and a build cache), then implement a fix script that enforces least-privilege permissions and blocks symlink traversal. The solution must harden SSH/GPG key directories and files, set sticky-bit and ownership on shared directories, and ensure artifact writes cannot escape the intended workspace.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Filesystem & Permission Security', 'Build a hardening utility that audits and remediates PATH hijacking and temp-dir permission issues: locate world-writable or non-root-owned directories in $PATH, detect user-writable shadow binaries preceding system utilities, and ensure /tmp and /var/tmp have the sticky bit. It must fix ownership/permissions or remove unsafe entries, reorder PATH safely, and emit a before/after compliance report proving that no PATH entry is writable by non-root and that core tools resolve to system binaries.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Filesystem & Permission Security', 'Identify and remediate a symlink race in a root-run log rotation script that compresses and moves files from /var/log/app, where an attacker can swap a log for a symlink to clobber or exfiltrate arbitrary files. Harden the rotation by rejecting symlinks/hardlinks and using O_NOFOLLOW-safe moves, then tighten permissions (logs 600, log dir 700) and emit a change report to /app/rotation_hardening_report.json.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Filesystem & Permission Security', 'Implement a policy-driven filesystem hardener that reads a YAML policy of expected owners, groups, and modes for specified paths, then audits and enforces them while stripping unsafe SUID/SGID bits and setting sticky bits on designated temp directories. It must detect and refuse symlink/hardlink escapes, correct insecure world-readable/writable permissions on secrets, and emit a machine-readable before/after report of all changes and blocks.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Network Security Configuration', 'Configure a stateful nftables firewall implementing a three-packet port-knocking sequence that temporarily opens SSH (port 22) for the knocking source IP, with automatic timeout and rate-limited logging of denied traffic. Provide idempotent scripts to install and persist the rules, and verify that incorrect sequences or scans never open the port and that access reverts after the timeout.', NULL, ARRAY['logging']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Network Security Configuration', 'Harden a Linux host with nftables by implementing a default-deny, stateful firewall that permits inbound HTTPS on 8443 to a sample service, rate-limits SSH (5/s, burst 10), blocks all IPv6, and enforces an egress allowlist (DNS/HTTPS) for both the host and a container bridge subnet. Provide a persistent ruleset and a verification script that proves container isolation, denied outbound ports, and rule survival after a ruleset reload.', 'hard', ARRAY['container']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Network Security Configuration', 'Harden the host by replacing permissive rules with an nftables default-deny policy that allows only inbound TCP 8443 and rate-limited SSH from 10.42.0.0/16, permits established/related traffic, and restricts egress to DNS, NTP, and HTTPS while logging first-hit drops to /var/log/nft-blocks.log via ulogd. Ensure the rules persist across reboot via /etc/nftables.conf and verify with connectivity tests that allowed paths work and blocked paths fail.', 'hard', ARRAY['logging']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Network Security Configuration', 'Implement host egress hardening using nftables: redirect all outbound TCP/80 to a local transparent proxy on 127.0.0.1:3128, allow only DNS and HTTPS to the Internet, block cloud metadata IP 169.254.169.254 and RFC1918 destinations, and set default-drop for everything else. Include a verification script that demonstrates allowed and blocked paths and writes a concise report to /app/firewall_report.txt.', 'hard', ARRAY['cloud']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'Network Security Configuration', 'Using nftables, implement a default-deny egress policy that only allows DNS to the system resolver and HTTPS to a domain whitelist managed as an IP set resolved from /app/allowed_domains.txt, with all other outbound connections rate-limited logged and dropped. Persist the rules in /etc/nftables.conf and provide /app/update_whitelist.sh to refresh the IP set so curl to allowed domains succeeds while others are blocked.', NULL, NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'System & Service Hardening', 'Harden a provided systemd service via a drop-in override that runs it as a dedicated user and applies systemd sandboxing (NoNewPrivileges, CapabilityBoundingSet, ProtectSystem=strict, PrivateTmp, ReadOnlyPaths, RestrictAddressFamilies, SystemCallFilter) while preserving its core UNIX-socket functionality. Tests confirm the service still works but cannot read /etc/shadow, write outside its working directory, bind TCP sockets, or retain elevated capabilities.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'System & Service Hardening', 'Harden a provided systemd unit for a demo HTTP service to enforce least privilege by using DynamicUser, dropping all capabilities, enabling NoNewPrivileges, sandboxing with ProtectSystem=strict/ProtectHome/PrivateTmp, restricting writable paths, and applying a strict SystemCallFilter. Demonstrate the service still functions on localhost while reads of /etc/shadow, execution of new binaries, and writes outside the allowed directory are denied, then output the final unit and a validation log to /app/result.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'System & Service Hardening', 'Harden a provided systemd-managed file-sync service by applying systemd sandboxing and least-privilege features (DynamicUser, capability bounding, filesystem and network/address-family restrictions). Verify the service still syncs files while being unable to write outside /var/lib/sync, read /etc/shadow, spawn a shell, or bind to privileged ports.', 'hard', NULL),
('Security & Cryptography', 'Secure Configuration & Hardening', 'System & Service Hardening', 'Harden a root-running Python web service by converting it into a sandboxed systemd unit that uses an unprivileged DynamicUser, drops capabilities, sets NoNewPrivileges, enforces ProtectSystem=strict/PrivateTmp, applies RestrictAddressFamilies/IPAddressDeny, and a seccomp SystemCallFilter. The service must still serve on localhost:8080 and write only to /var/lib/app, while tests verify it cannot read /etc/shadow, spawn a shell, or make outbound network connections.', 'hard', ARRAY['python', 'web']),
('Security & Cryptography', 'Secure Configuration & Hardening', 'System & Service Hardening', 'Install and harden OpenSSH by creating a non-root deploy user, disabling root and password authentication, enforcing Ed25519 key-only access with modern Ciphers/MACs/KexAlgorithms, and restricting logins to that user via AllowUsers. Prove hardening by successfully logging in to localhost with the key while root/password logins fail, and write the final sshd_config and test results to /app/output.', 'hard', ARRAY['logging']),
('Security & Cryptography', 'Secure Software Development', 'Input Validation & Sanitization', 'Harden a CSV export CLI to prevent spreadsheet formula injection by neutralizing fields that begin with =, +, -, @, or a tab and removing embedded CR/LF control characters from untrusted input. Preserve delimiter/quoting behavior, field order, and whitespace so output is identical except for safely neutralized cells.', 'hard', NULL),
('Security & Cryptography', 'Secure Software Development', 'Input Validation & Sanitization', 'Harden a Node.js CLI that shells out to ImageMagick using user-provided format, size, and filename by replacing string-based exec with safe argument arrays and strict schema validation. Enforce a whitelist of formats, bounded numeric dimensions, and sanitized filenames to prevent command injection while preserving legitimate conversions and exact output naming.', 'hard', NULL),
('Security & Cryptography', 'Secure Software Development', 'Input Validation & Sanitization', 'Harden a Node.js CSV import/export pipeline to prevent spreadsheet formula injection by validating cell content, normalizing Unicode, and prefix-escaping dangerous leading characters (=,+,-,@) while preserving numeric/date parsing and encoding. Rebuild the project and confirm that benign CSVs round-trip unchanged.', 'hard', NULL),
('Security & Cryptography', 'Secure Software Development', 'Input Validation & Sanitization', 'Patch a Python backup CLI that currently builds a shell command like "tar cf - <path> | {compressor} > out.tar.{ext}" from user input, allowing command injection and path traversal. Refactor to use subprocess with argument lists, whitelist compressor choices (gzip/bzip2/xz), canonicalize and restrict the source path to an allowed base directory, and enforce length/charset limits while preserving normal backup behavior.', NULL, ARRAY['python']),
('Security & Cryptography', 'Secure Software Development', 'Input Validation & Sanitization', 'Refactor a FastAPI + SQLite microservice that currently builds SQL from query parameters to enforce strict validation and sanitization using parameterized queries and Pydantic validators (types, length limits, regex whitelists), returning 400s for disallowed input. Include a CLI verifier that exercises endpoints to prove SQLi payloads are neutralized while valid requests still return correct results.', NULL, ARRAY['sql']),
('Security & Cryptography', 'Secure Software Development', 'Secrets & Key Management in Codebases', 'Convert all plaintext secrets in the repo to SOPS-encrypted files using age, adding a .sops.yaml policy and scripts to encrypt/decrypt/rotate while modifying the app to load secrets from environment or decrypted files. Rewrite Git history to remove the original cleartext and install a pre-commit hook that rejects new secret leaks; the harness verifies no secret bytes remain in blobs, packs, or tags and that the hook blocks a seeded leak.', NULL, ARRAY['git']),
('Security & Cryptography', 'Secure Software Development', 'Secrets & Key Management in Codebases', 'Create a Git-aware remediation tool that scans the working tree and full history for hardcoded credentials (provider patterns + entropy), migrates them to environment-driven config backed by a local dotenv/JSON store, and rewrites code to use lookups. The script must purge secrets from history, install a pre-commit hook to block future leaks, and emit a machine-readable report verifying no secrets remain and the app runs with injected env vars.', 'hard', ARRAY['git']),
('Security & Cryptography', 'Secure Software Development', 'Secrets & Key Management in Codebases', 'Identify hardcoded OAuth client secret and JWT signing key in a Node.js service, migrate them to Docker Compose secrets and a .env file with properly generated replacements, and refactor the code and compose config to consume them securely. Add a git pre-commit hook that blocks future secret leaks and demonstrate the app still authenticates and issues tokens using the rotated keys.', 'hard', ARRAY['docker', 'git']),
('Security & Cryptography', 'Secure Software Development', 'Secrets & Key Management in Codebases', 'Refactor a Node.js Express authentication service that currently hardcodes an HS256 JWT secret to use RS256 keys with a local JWKS endpoint and automated key rotation, loading private keys from a protected file path or env-injected secret. Update the app and tests so tokens include a kid, the public JWKS rotates without downtime, and no secrets remain in the repository or Docker build context.', 'hard', ARRAY['docker']),
('Security & Cryptography', 'Secure Software Development', 'Secrets & Key Management in Codebases', 'Scan the repository (including full Git history) to locate hardcoded secrets, rewrite history to purge them, and migrate the values into a SOPS-encrypted secrets.yaml secured with an AGE keypair while refactoring code to read from environment variables. Verify by showing the application runs using decrypted env at runtime and that a secret scanner reports no findings in the working tree or history with only the encrypted file tracked.', 'hard', ARRAY['git']),
('Security & Cryptography', 'Secure Software Development', 'Secure Build & Dependency Management', 'Audit a Python package that includes a Rust extension (built with maturin) using pip-audit and cargo-audit, then apply minimal semver-safe upgrades via constraints.txt and Cargo.toml updates/patches to eliminate all high/critical advisories without altering CLI behavior. Rebuild the wheel, regenerate lockfiles/SBOM, ensure tests pass, and write a JSON report of remediated CVEs to /app/vuln_report.json.', NULL, ARRAY['python', 'rust']),
('Security & Cryptography', 'Secure Software Development', 'Secure Build & Dependency Management', 'Build a CLI that scans a monorepo’s Python (pip) and Node (npm) dependencies with OSV/pip-audit/npm audit, applies minimal non-breaking upgrades to eliminate high/critical CVEs, and regenerates lockfiles with hash/integrity pins. It must emit pre/post CycloneDX SBOMs, run the project tests to validate the upgrade, and fail the run if vulnerabilities persist or the build is not reproducible.', NULL, ARRAY['python']);
