-- Compact batch 23/29: rows 1101-1150

INSERT INTO task_inspiration (category, subcategory, subsubcategory, description, difficulty, tags) VALUES
('Security & Cryptography', 'Secure Software Development', 'Secure Build & Dependency Management', 'In a mixed Python/Node project, use pip-audit and npm audit to identify one direct and one transitive vulnerable dependency, then remediate with minimal safe upgrades by pinning versions (requirements/constraints and package.json overrides) and regenerating lockfiles with strict hash verification. Enforce deterministic offline installs via pip.conf and .npmrc (require-hashes, npm ci with scripts disabled), generate CycloneDX SBOMs, and output a brief report of fixed CVEs and final versions.', NULL, ARRAY['python']),
('Security & Cryptography', 'Secure Software Development', 'Secure Build & Dependency Management', 'In a polyglot monorepo (Python, Node.js, and Rust), audit dependencies with pip-audit, npm audit, and cargo audit, then apply the minimal safe upgrades and regenerate lockfiles with hashes. Emit a consolidated CycloneDX SBOM and JSON advisory report, wire a CI script to fail on new critical CVEs, and verify builds and tests still pass.', NULL, ARRAY['python', 'rust']),
('Security & Cryptography', 'Secure Software Development', 'Secure Build & Dependency Management', 'Scan a Python + Node monorepo with pip-audit and npm audit, then apply minimal safe upgrades via constraints.txt and npm overrides to remove all High/Critical findings and regenerate lockfiles. Output a unified JSON diff of vulnerabilities before/after and enforce deterministic installs with pip --require-hashes and intact npm integrity fields.', NULL, ARRAY['python']),
('Security & Cryptography', 'Secure Software Development', 'Static Code Analysis & Vulnerability Detection', 'Author a custom Semgrep rule set that models taint flow across a mixed Python/Node.js codebase to detect untrusted input reaching command execution, SQL queries (string interpolation), and unsafe path joins (zip-slip). Run the rules to produce a SARIF report, refactor the code to remediate all high-severity findings, and re-run to confirm zero remaining issues.', NULL, ARRAY['python', 'sql']),
('Security & Cryptography', 'Secure Software Development', 'Static Code Analysis & Vulnerability Detection', 'Create a Semgrep taint-mode rule pack that detects flows from Flask request inputs to sqlite3 query execution (SQL injection) and to filesystem access (path traversal), outputting findings in SARIF. Run the scan on a provided Flask app, then refactor to parameterize queries and normalize/whitelist file paths, and re-scan to verify zero findings.', NULL, ARRAY['sql']),
('Security & Cryptography', 'Secure Software Development', 'Static Code Analysis & Vulnerability Detection', 'Install and run Bandit and Semgrep on a deliberately vulnerable Python microservice, and author custom Semgrep rules to detect ECB mode, static IVs, weak hashes, and subprocess calls with shell=True, then refactor the code to remove all findings. Produce before/after SARIF reports and a CI-failing script that exits non‑zero if any critical issues remain.', NULL, ARRAY['python']),
('Security & Cryptography', 'Secure Software Development', 'Static Code Analysis & Vulnerability Detection', 'Run Semgrep (community security rules) and Bandit on a mixed Python/Node codebase to detect command injection, unsafe YAML loading, path traversal, and insecure temp-file/cookie settings. Fix the findings with minimal behavioral change, add a pre-commit and CI configuration that fails on reintroduction, and emit a before/after SARIF or JSON report to /app/output/findings.json.', NULL, ARRAY['security', 'python']),
('Security & Cryptography', 'Secure Software Development', 'Static Code Analysis & Vulnerability Detection', 'Scan a mixed Java/Python codebase for XML External Entity (XXE) vulnerabilities using Semgrep/Bandit, author at least one custom rule per language to detect unsafe parser instantiation, and refactor the code to harden XML processing (disable DTDs and external entities) without changing observable behavior. Re-run the analyzers to confirm zero findings and ensure all tests still pass.', 'hard', ARRAY['java', 'python']),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Alerting & Incident Response Automation', 'Build a correlation-driven incident responder that tails auth and web access logs to detect account takeover patterns (failed logins from IP A, success from IP B, then privileged action within 5 minutes) and, upon detection, automatically disables the user, revokes sessions, writes a firewall block, and emits both JSON and human-readable alerts with a timeline. Provide an executable CLI to replay logs from files for testing and a stateful deduplication mechanism with auto-expiry of blocks.', NULL, ARRAY['web', 'testing']),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Alerting & Incident Response Automation', 'Build a lightweight fail2ban-style responder that tails a custom service log, detects credential-stuffing/401-flood patterns via a regex filter, and posts JSON alerts to a local webhook endpoint. On threshold breach, automatically quarantine offending IPs by appending to a persistent blocklist enforced by a provided mock-firewall script, with tests that simulate attacks and benign traffic to verify correct alerting and no false positives.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Alerting & Incident Response Automation', 'Configure auditd to log reads of files under /app/secrets and any subsequent outbound network connection by the same PID, then build a responder that correlates events within 10 seconds, quarantines the executable and blocks its egress via nftables. The responder must also POST a JSON alert to a local webhook and write a detailed incident record to /app/incidents/incident-*.json.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Alerting & Incident Response Automation', 'Implement a real-time incident responder that tails auth and HTTP logs, loads YAML rule files defining thresholds over sliding windows, and on matches emits HMAC-signed JSON alerts while executing mapped actions (append IP with TTL to /app/blocked_ips, lock a user, or disable a service) and producing a triage bundle with relevant logs, process tree, and socket info. Validation simulates brute-force SSH and repeated 403s, expecting alert files in /app/alerts, auto-expiring IP entries, and timestamped incident report directories with captured evidence.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Audit Logging & Monitoring Setup', 'Configure Linux auditd to record execve events for privileged commands and writes under /etc, enable persistent journald storage, and set up rsyslog (via imjournal) to forward auth/kern/daemon logs to a local RELP+TLS syslog listener with certificate pinning. Verify by triggering sudo, user management, and config file edits, then assert the events appear in ausearch and in the forwarded stream with correct timestamps, host metadata, and persistence across service restarts.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Audit Logging & Monitoring Setup', 'Configure auditd and systemd-journald for persistent, immutable auditing of privileged execve events and file writes under /app/secret, and set up rsyslog to forward audit and authpriv logs over TLS to a provided local syslog endpoint. Trigger test events and produce /app/output/verification.txt proving capture locally and remotely, and that rules persist after service and system restarts.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Audit Logging & Monitoring Setup', 'Configure persistent journald storage and auditd rules to record execve, sudo usage, writes to /etc/ssh, and kernel module loads with distinct AUDIT_KEY tags. Bridge audit logs into journald and forward them via systemd-journal-upload to a local journal-remote collector, then trigger each event and verify receipt with expected fields and counts.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Audit Logging & Monitoring Setup', 'Configure persistent system-wide logging by enabling systemd-journald persistence and auditd with rules to track /etc changes, kernel module loads, and executions of privileged binaries, then forward events via rsyslog over TLS to a local mock SIEM listener. Validate by triggering sample events and confirming they appear in persistent logs, are rotated with a 7‑day retention policy, and are received by the SIEM with hostname and UTC timestamps.', NULL, ARRAY['logging']),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Audit Logging & Monitoring Setup', 'Enable persistent journald storage and configure auditd rules to log all execve by uid 0, any chmod that adds setuid/setgid bits, and writes under /app/secure. Validate by triggering events and generate /app/audit_report.json summarizing counts and the latest five matching events from both audit logs and the journal.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Security Policy Compliance', 'Build a CLI tool that audits a Linux host’s PAM and OpenSSH configurations against selected CIS Level 1 controls (e.g., password length/history, account lockout, root login, approved ciphers/MACs), performs safe in-place remediations to achieve compliance, and generates a machine-readable before/after compliance report. Tests validate by parsing system configs and the emitted JSON to confirm each control’s state transitioned to compliant.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Security Policy Compliance', 'Build a lightweight compliance tool that gathers Linux system facts to JSON and evaluates them with OPA/Rego policies implementing a subset of CIS Linux controls, emitting both JUnit XML and a human-readable report in /app/report. Provide idempotent remediation scripts for failing checks (e.g., SSH root login, file permissions, password aging), re-run to reach at least 90% passing, and archive before/after evidence.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Security Policy Compliance', 'Build a terminal-based compliance scanner/remediator that evaluates a Debian/Ubuntu image against a small set of CIS Level 1 controls (SSH configuration, password/PAM policy, world-writable files, and root PATH safety), emitting a deterministic JSON report to /app/output/report.json. When invoked with --fix, apply compliant changes idempotently and record a rollback plan at /app/output/rollback.sh.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Security Policy Compliance', 'Create a policy-as-code CLI that loads YAML control definitions aligned to NIST 800-53/CIS (each with check commands, expected outcomes, and remediation steps), executes them to produce a JSON compliance report with evidence artifacts, and optionally applies fixes via --enforce. Validation targets include SSH root login policy, PAM password complexity, permissions on /etc/passwd and /etc/shadow, and ensuring auditd is enabled and persistent.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Security Policy Compliance', 'Implement a Python CLI that validates a minimal CIS Ubuntu Server baseline by auditing password/PAM policy, SSH hardening, key sysctl settings, and world-writable permissions, emitting a structured JSON pass/fail report with remediation guidance. Provide an idempotent --fix mode that backs up affected files and applies compliant configurations where safe.', 'hard', ARRAY['python']),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Vulnerability Scanning & Reporting', 'Build a CLI that generates an SBOM for a local project, scans it with Trivy and Grype in offline mode, de-duplicates CVEs, and emits both SARIF and an HTML dashboard. Enforce a YAML-defined policy to suppress known issues and fail on configurable severity thresholds, including recommended fixed versions and dependency paths in the report.', NULL, NULL),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Vulnerability Scanning & Reporting', 'Create a CLI that scans a provided Docker image and its source tree with both Trivy and Grype, merges and deduplicates CVE findings, and emits SARIF plus a concise markdown summary with severity counts and fix-available mapping before/after remediation. Update the Dockerfile and dependency manifests with minimal pinned upgrades to reduce all Critical findings with fixes to zero, then prove compliance by rescanning and writing pass to /app/gate.status.', NULL, ARRAY['docker']),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Vulnerability Scanning & Reporting', 'Scan a provided Docker image with Trivy, output a CycloneDX SBOM (/app/report/sbom.json) and SARIF findings (/app/report/trivy.sarif), then refactor the Dockerfile and dependency pins to remediate all HIGH/CRITICAL vulnerabilities. Add a .trivyignore entry for a documented vendor-backported CVE, rebuild and rescan to verify zero remaining HIGH/CRITICAL except the ignored CVE, and write a concise remediation summary to /app/report/summary.txt.', NULL, ARRAY['docker']),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Vulnerability Scanning & Reporting', 'Scan a provided container image and its running service with Trivy and nmap to generate a consolidated SARIF report, then refactor the Dockerfile and service configuration to remediate all Critical findings and close an inadvertently exposed admin port. Rebuild and re-scan to verify the report shows zero Critical/High CVEs and the admin port is unreachable, saving before/after reports in /app/reports.', NULL, ARRAY['container']),
('Security & Cryptography', 'Security Monitoring & Compliance', 'Vulnerability Scanning & Reporting', 'Scan the provided container image tarball at /app/images/webapp.tar using Trivy, output a SARIF report and a CSV listing only fixable High/Critical CVEs sorted by CVSS. Then create /app/output/Dockerfile.patched that updates the base image and pinned packages to remediate all fixable findings without altering the container’s entrypoint or command.', NULL, ARRAY['container']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Common Vulnerability Reproduction', 'Exploit JWT algorithm confusion in a Node.js API that mistakenly accepts HS256 for tokens intended to be RS256 by using the server’s public key as the HMAC secret to forge an admin token and retrieve the admin-only secret to /app/secret.txt. Then harden the authentication middleware to strictly enforce RS256 with the correct key material while preserving normal login behavior.', 'hard', ARRAY['api']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Common Vulnerability Reproduction', 'Investigate a C logging daemon with a format-string vulnerability in printf that allows leaking stack memory; craft an input to extract FLAG{...} and write it to /app/flag.txt, then patch the code to use fixed format strings and recompile, confirming normal logging still works.', NULL, ARRAY['logging']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Common Vulnerability Reproduction', 'Reproduce an XML External Entity (XXE) vulnerability in a service that parses uploaded XML files by crafting a payload to read /app/flag.txt and save the contents to /app/leak.txt. Then harden the XML parser to disable external entities and DTDs while preserving normal document handling.', 'hard', NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Common Vulnerability Reproduction', 'Reproduce an unsafe deserialization flaw in a Python CLI that loads untrusted YAML using yaml.load by crafting a payload that triggers benign code execution (e.g., creating /app/pwned.txt). Then harden the program to use a safe loader while preserving valid configuration behavior and verify the exploit is no longer effective.', 'hard', ARRAY['python']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Common Vulnerability Reproduction', 'Reproduce and mitigate a ZIP Slip directory traversal in a Python CLI that naively extracts user-submitted archives. Craft a malicious ZIP to write a marker file outside the intended directory, then patch the extractor to sanitize paths so extraction is safe and idempotent.', NULL, ARRAY['python']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Exploit Development & Analysis', 'Analyze a custom C-based CLI notes service with a heap use-after-free bug and develop a minimal exploit that achieves arbitrary read to extract a secret from /app/secret.bin without crashing the process. Then implement and rebuild a hardening patch (e.g., pointer invalidation and allocator checks) that eliminates the bug while preserving normal functionality.', 'hard', NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Exploit Development & Analysis', 'Analyze a hardened 64-bit ELF service to locate a format-string vulnerability, then craft a multi-stage exploit that leaks stack/libc addresses and overwrites a GOT entry to redirect execution to a hidden print_secret() routine. Write the recovered secret to /app/flag.txt after successful exploitation.', 'hard', NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Exploit Development & Analysis', 'Develop a PoC exploit against a sandboxed 64-bit Linux ELF service with a format-string bug in its logging path: leak the stack canary and libc base, then craft a ret2libc/ROP payload that creates three marker files to prove control. Provide an automated script that launches the target, derives offsets under ASLR with NX enabled, delivers the exploit reliably, and verifies the markers.', NULL, ARRAY['logging']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Exploit Development & Analysis', 'Develop a Python exploit that performs a CBC padding oracle attack against a provided local HTTP service to recover the plaintext of an encrypted session token and forge a valid admin token to access a protected endpoint. Include a concise analysis of the oracle behavior and implement a mitigation that removes the side-channel while preserving normal application behavior.', NULL, ARRAY['python']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Exploit Development & Analysis', 'Develop a proof-of-concept that exploits JWT algorithm confusion in a local API by re-signing an RS256 token as HS256 using the service’s RSA public key to forge an admin token and trigger a privileged action that writes /app/pwned.txt. Add brief inline analysis of the root cause and mitigations (algorithm whitelisting and key-type separation).', NULL, ARRAY['api']),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Patch Verification & Mitigation Testing', 'Build a deliberately vulnerable C binary with a stack buffer overflow, exploit it to achieve code execution on an unprotected build, then rebuild with hardening (ASLR, NX, stack canaries, PIE, full RELRO) enabled. Programmatically verify mitigations via ELF inspection and /proc/sys checks, rerun the exploit to confirm it fails, and output a concise pass/fail report.', 'hard', NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Patch Verification & Mitigation Testing', 'Build a deliberately vulnerable C service and an automated harness that compiles it twice (unhardened vs hardened with stack canaries, NX, PIE, full RELRO, and FORTIFY), verifies each mitigation via readelf/sysctl, and runs a supplied overflow input. The report must show the exploit succeeds only on the unhardened build while the hardened build safely aborts, failing the task if any mitigation is missing or ineffective.', 'hard', NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Patch Verification & Mitigation Testing', 'Compile and run a vulnerable C program that attempts to execute stack-injected shellcode and a companion probe that records memory addresses across multiple executions. Verify NX and ASLR are effective by confirming the shellcode attempt crashes without code execution and that address layouts vary significantly across ≥20 runs, then output a machine-readable mitigation_report.json in /app.', NULL, NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Patch Verification & Mitigation Testing', 'Create an automated harness that compiles a deliberately vulnerable C program under four builds (no mitigations, stack canary, NX/DEP, PIE+ASLR), runs a provided overflow exploit, and verifies exploitation only succeeds when the relevant mitigations are absent. The script must also assert mitigation presence via binary introspection (e.g., readelf/objdump symbols, GNU_STACK, PIE) and system checks (/proc/sys/kernel/randomize_va_space), outputting a machine-readable report of flags detected and exploit outcomes.', NULL, NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Patch Verification & Mitigation Testing', 'Rebuild a provided overflow-vulnerable C service with hardening (stack canaries, PIE, full RELRO, NX) and enable ASLR, then verify each mitigation via ELF/Procfs inspection. Demonstrate that the supplied working exploit succeeds pre-harden and reliably fails post-harden, recording evidence to a verification file.', 'hard', NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Privilege Escalation Demonstrations', 'Exploit a misconfigured sudoers rule granting NOPASSWD access to a root-run backup helper that invokes tar over a user-writable directory with unquoted wildcards. Discover the entry and escalate via tar option/wildcard injection to execute code as root, proving success by creating /root/pe_proof.txt.', NULL, NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Privilege Escalation Demonstrations', 'Exploit a root-run backup script that calls utilities without absolute paths and executes in a user-writable directory by performing a PATH hijack to gain root and prove it by creating /root/owned.txt. Then remediate by hardcoding absolute paths and fixing permissions so the backup still works but the escalation is no longer possible.', 'hard', NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Privilege Escalation Demonstrations', 'Exploit a root-run cron backup script that invokes commands via an insecure PATH and a world-writable /usr/local/bin by dropping a malicious shim to hijack execution and gain root. Read /root/flag.txt and write a byte-identical copy to /app/flag.txt.', NULL, NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Privilege Escalation Demonstrations', 'Exploit a sudoers misconfiguration that permits running tar as root to achieve privilege escalation by abusing tar’s extended features to execute a root-owned payload, then prove success by creating /root/pe_proof.txt and exporting a protected file to /app/shadow_copy. The task includes a decoy backup workflow and must be completed without editing sudoers or using external tools.', NULL, NULL),
('Security & Cryptography', 'Vulnerability Demonstration & Exploitation', 'Privilege Escalation Demonstrations', 'Starting as an unprivileged user, exploit a sudoers misconfiguration that permits passwordless tar to escalate via --checkpoint-action=exec (or crafted wildcard injection), then prove root by creating /root/owned.txt. Mitigate by tightening the sudoers rule to a safe, argument-pinned form so the exploit is no longer possible.', NULL, NULL),
('Software Engineering & Development', 'Code Maintenance, Refactoring & Optimization', 'Architecture & Modularization', 'Refactor a monolithic Python CLI in /app/tool.py into a modular package with a plugin architecture, splitting core parsing, IO, and business logic into reusable modules and dynamically discovering subcommands from a plugins/ namespace (or entry points) while preserving the exact CLI and outputs. Add a thin library API, dependency inversion for side effects, and an environment variable to control plugin loading for deterministic runs.', NULL, ARRAY['python', 'api']),
('Software Engineering & Development', 'Code Maintenance, Refactoring & Optimization', 'Architecture & Modularization', 'Refactor a monolithic Python log-ingestion CLI into a modular package with layered components (parsers, processors, sinks) and a plugin system that discovers extensions via entry points. Preserve the original CLI flags and output behavior while enabling backend swapping through configuration and dependency injection.', NULL, ARRAY['python', 'backend']),
('Software Engineering & Development', 'Code Maintenance, Refactoring & Optimization', 'Architecture & Modularization', 'Refactor a single-file Python data-cleaning CLI at /app/monolith.py into a modular package with a core library, a thin CLI, and a plugin system using setuptools entry points for pluggable transforms while preserving identical CLI behavior and outputs. Include an in-tree example plugin and ensure both the CLI and importable API use the same core logic verified by tests.', NULL, ARRAY['python', 'api']);
